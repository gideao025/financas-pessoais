<section class="mx-auto flex w-full max-w-6xl flex-col gap-6">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <div>
      <h2 class="text-3xl font-black tracking-tight">Transações e Registros</h2>
      <p class="text-sm text-[#64748b]">Histórico completo de movimentações com filtros.</p>
    </div>
    <div class="flex items-center gap-2">
      <button class="rounded-xl bg-primary px-4 py-2 text-sm font-bold text-white hover:bg-primary/90" (click)="painelAberto.set(true)">Adicionar Nova Transação</button>
      <button class="rounded-xl bg-[#eef2f6] px-4 py-2 text-sm font-bold dark:bg-[#24313f]" (click)="adicionarMock()">+ Mock</button>
    </div>
  </div>

  <div class="rounded-2xl border border-[#dbe0e6] bg-white p-4 dark:border-[#2a3441] dark:bg-[#1a242f]">
    <div class="flex flex-wrap items-center gap-2">
      <label class="relative min-w-[220px] flex-1">
        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-[#64748b] text-lg">search</span>
        <input class="w-full rounded-lg border-none bg-[#f0f2f4] py-2 pl-10 pr-3 text-sm focus:ring-2 focus:ring-primary dark:bg-[#24313f]" placeholder="Pesquisar transações..." [value]="busca()" (input)="busca.set(($any($event.target)).value); pageIndex.set(1)" />
      </label>
      <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="periodoSelecionado()" (change)="periodoSelecionado.set(($any($event.target)).value); pageIndex.set(1)">
        <option value="esteMes">Período: Este Mês</option>
        <option value="todos">Período: Todos</option>
      </select>
      <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="categoriaSelecionada()" (change)="categoriaSelecionada.set(($any($event.target)).value); pageIndex.set(1)">
        <option value="todas">Categoria: Todas</option>
        <option *ngFor="let c of categoriasDisponiveis()" [value]="c">{{ c }}</option>
      </select>
      <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="contaSelecionada()" (change)="contaSelecionada.set(($any($event.target)).value); pageIndex.set(1)">
        <option value="todas">Conta: Todas</option>
        <option *ngFor="let c of contasDisponiveis()" [value]="c">{{ c }}</option>
      </select>
      <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="tipoSelecionado()" (change)="tipoSelecionado.set(($any($event.target)).value); pageIndex.set(1)">
        <option value="todos">Tipo: Todos</option>
        <option value="entrada">Tipo: Entrada</option>
        <option value="saida">Tipo: Saída</option>
      </select>
      <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="statusSelecionado()" (change)="statusSelecionado.set(($any($event.target)).value); pageIndex.set(1)">
        <option value="todos">Status: Todos</option>
        <option value="concluida">Status: Concluída</option>
        <option value="pendente">Status: Pendente</option>
      </select>
      <div class="ml-auto flex items-center gap-2">
        <select class="h-9 rounded-lg bg-[#f0f2f4] px-3 text-sm dark:bg-[#24313f]" [value]="pageSize()" (change)="atualizarPageSize($event)">
          <option [value]="5">Exibir: 5</option>
          <option [value]="10">Exibir: 10</option>
          <option [value]="20">Exibir: 20</option>
        </select>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-[1fr_360px] gap-6">
    <article class="overflow-hidden rounded-2xl border border-[#dbe0e6] bg-white dark:border-[#2a3441] dark:bg-[#1a242f]">
      <table class="w-full min-w-[760px] text-left">
        <thead class="bg-[#fcfcfd] dark:bg-[#24313f]">
          <tr class="border-b border-[#dbe0e6] dark:border-[#2a3441] text-xs uppercase tracking-wider text-[#64748b]">
            <th class="px-5 py-4">Data</th>
            <th class="px-5 py-4">Descrição</th>
            <th class="px-5 py-4">Categoria</th>
            <th class="px-5 py-4">Conta</th>
            <th class="px-5 py-4 text-right">Valor</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-[#dbe0e6] dark:divide-[#2a3441]">
          <tr *ngFor="let item of pagina()" class="hover:bg-[#f8fafc] dark:hover:bg-[#24313f]">
            <td class="px-5 py-4 text-sm">{{ item.data | date: 'dd MMM, yyyy' : '' : 'pt-BR' }}</td>
            <td class="px-5 py-4 text-sm font-semibold">{{ item.descricao }}</td>
            <td class="px-5 py-4"><span class="rounded-full bg-[#eef2f5] px-2.5 py-0.5 text-xs dark:bg-[#24313f]">{{ item.categoria }}</span></td>
            <td class="px-5 py-4 text-sm text-[#64748b]">{{ item.conta }}</td>
            <td class="px-5 py-4 text-right text-sm font-bold" [ngClass]="item.tipo === 'entrada' ? 'text-green-600' : 'text-red-500'">{{ item.tipo === 'entrada' ? '+' : '-' }}{{ item.valor | currency: 'BRL' : 'symbol' : '1.2-2' : 'pt-BR' }}</td>
          </tr>
        </tbody>
      </table>
      <div class="flex items-center justify-between px-5 py-4 border-t border-[#dbe0e6] dark:border-[#2a3441]">
        <p class="text-sm text-[#64748b]">Exibindo {{ inicioExibido() }} a {{ fimExibido() }} de {{ totalFiltradas() }} transações</p>
        <div class="flex items-center gap-1">
          <button class="flex size-9 items-center justify-center rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f]" (click)="antPagina()">
            <span class="material-symbols-outlined text-lg">chevron_left</span>
          </button>
          <button class="flex size-9 items-center justify-center rounded-lg bg-primary text-white text-xs font-bold" (click)="setPage(1)">1</button>
          <button class="flex size-9 items-center justify-center rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f]" (click)="setPage(2)">2</button>
          <button class="flex size-9 items-center justify-center rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f]" (click)="setPage(3)">3</button>
          <span class="size-9 flex items-center justify-center text-[#64748b]">...</span>
          <button class="flex size-9 items-center justify-center rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f]" (click)="setPage(totalPages())">{{ totalPages() }}</button>
          <button class="flex size-9 items-center justify-center rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f]" (click)="proxPagina()">
            <span class="material-symbols-outlined text-lg">chevron_right</span>
          </button>
        </div>
      </div>
    </article>

    <aside *ngIf="painelAberto()" class="hidden w-[360px] lg:flex flex-col rounded-2xl border border-[#dbe0e6] bg-white dark:border-[#2a3441] dark:bg-[#1a242f]">
      <div class="flex items-center justify-between px-4 py-3 border-b border-[#dbe0e6] dark:border-[#2a3441]">
        <h3 class="text-lg font-bold">Adicionar Transação</h3>
        <button class="rounded-lg hover:bg-[#eef2f6] dark:hover:bg-[#24313f] p-1" (click)="painelAberto.set(false)">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="p-4 space-y-4">
        <label class="space-y-1">
          <span class="text-xs font-bold">Valor</span>
          <input class="w-full rounded-lg bg-[#f0f2f4] dark:bg-[#24313f] border-none h-10 px-3 text-sm" placeholder="0,00" [value]="formValor()" (input)="formValor.set(($any($event.target)).value)" />
        </label>
        <div class="flex gap-2">
          <button class="flex-1 rounded-lg border px-3 py-2 text-xs font-bold" [ngClass]="formTipo() === 'saida' ? 'border-primary text-primary' : 'text-[#64748b]'" (click)="formTipo.set('saida')">Despesas</button>
          <button class="flex-1 rounded-lg border px-3 py-2 text-xs font-bold" [ngClass]="formTipo() === 'entrada' ? 'border-primary text-primary' : 'text-[#64748b]'" (click)="formTipo.set('entrada')">Receitas</button>
        </div>
        <label class="space-y-1">
          <span class="text-xs font-bold">Data</span>
          <input class="w-full rounded-lg bg-[#f0f2f4] dark:bg-[#24313f] border-none h-10 px-3 text-sm" type="date" [value]="formData()" (input)="formData.set(($any($event.target)).value)" />
        </label>
        <label class="space-y-1">
          <span class="text-xs font-bold">Descrição</span>
          <input class="w-full rounded-lg bg-[#f0f2f4] dark:bg-[#24313f] border-none h-10 px-3 text-sm" placeholder="Onde você gastou?" [value]="formDescricao()" (input)="formDescricao.set(($any($event.target)).value)" />
        </label>
        <label class="space-y-1">
          <span class="text-xs font-bold">Categoria</span>
          <select class="w-full rounded-lg bg-[#f0f2f4] dark:bg-[#24313f] border-none h-10 px-3 text-sm" [value]="formCategoria()" (change)="formCategoria.set(($any($event.target)).value)">
            <option *ngFor="let c of categoriasDisponiveis()" [value]="c">{{ c }}</option>
          </select>
        </label>
        <label class="space-y-1">
          <span class="text-xs font-bold">Conta</span>
          <select class="w-full rounded-lg bg-[#f0f2f4] dark:bg-[#24313f] border-none h-10 px-3 text-sm" [value]="formConta()" (change)="formConta.set(($any($event.target)).value)">
            <option *ngFor="let c of contasDisponiveis()" [value]="c">{{ c }}</option>
          </select>
        </label>
        <div class="pt-2">
          <button class="w-full rounded-xl bg-primary py-2.5 text-sm font-bold text-white hover:bg-primary/90" (click)="salvarTransacao()">Salvar Transação</button>
        </div>
      </div>
    </aside>
  </div>
</section>
